### SFINAE

SFINAE ‚Äî –æ—Å–æ–±–∞—è —à–∞–±–ª–æ–Ω–Ω–∞—è –º–∞–≥–∏—è C++.

SFINAE (–∞–Ω–≥–ª. substitution failure is not an error, ¬´–Ω–µ—É–¥–∞–≤—à–∞—è—Å—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî –Ω–µ –æ—à–∏–±–∫–∞¬ª) ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º —è–∑—ã–∫–∞ C++, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å —à–∞–±–ª–æ–Ω–∞–º–∏ –∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–π.

–ü—Ä–∞–≤–∏–ª–æ SFINAE –≥–ª–∞—Å–∏—Ç: **–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–∏–ø—ã –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (–ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É —à–∞–±–ª–æ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤) –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ–π —à–∞–±–ª–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É, –∞ –∏—â–µ—Ç –¥—Ä—É–≥—É—é –ø–æ–¥—Ö–æ–¥—è—â—É—é –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É.** –û—à–∏–±–∫–∞ –±—É–¥–µ—Ç –≤ —Ç—Ä—ë—Ö —Å–ª—É—á–∞—è—Ö:

* –ù–µ –Ω–∞—à–ª–æ—Å—å –Ω–∏ –æ–¥–Ω–æ–π –ø–æ–¥—Ö–æ–¥—è—â–µ–π –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏.
* –ù–∞—à–ª–æ—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–∏—Ö –ø–µ—Ä–µ–≥—Ä—É–∑–æ–∫, –∏ –°–∏++ –Ω–µ –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å, –∫–∞–∫—É—é –≤–∑—è—Ç—å.
* –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –Ω–∞—à–ª–∞—Å—å, –æ–Ω–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å —à–∞–±–ª–æ–Ω–Ω–æ–π, –∏ –ø—Ä–∏ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏–∏ —à–∞–±–ª–æ–Ω–∞ —Å–ª—É—á–∏–ª–∞—Å—å –æ—à–∏–±–∫–∞.

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —É –Ω–∞—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã —à–∞–±–ª–æ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–π, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Å–ª—É—á–∞–∏ –∂–∏–∑–Ω–∏, –∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –±—É–¥–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—è—Å—å –Ω–∞ –∑–∞–±–æ—Ç–ª–∏–≤–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∞–º–∏ ¬´–ø–æ–¥—Å–∫–∞–∑–∫–∏¬ª.

–û—Ç –Ω–∞—Å —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ, –ª–∏—à—å –±—ã –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö, –∫—Ä–æ–º–µ –Ω—É–∂–Ω–æ–≥–æ –Ω–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω—É —Ç–∏–ø-–∞—Ä–≥—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º).

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SFINAE –æ–±–ª–µ–≥—á–∞—é—Ç –¥–≤–µ –≤–µ—â–∏: `std::enable_if` –∏ [type traits](Types.md).

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `std::enable_if` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```c++
template<bool B, class T = void>
struct enable_if {};
  
template<class T>
struct enable_if<true, T> { typedef T type; };
```

–≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω—É–∂–Ω–∞ –ª–∏—à—å –¥–ª—è –æ–¥–Ω–æ–π —Ü–µ–ª–∏: —É –Ω–µ—ë —Ç–æ –µ—Å—Ç—å, —Ç–æ –Ω–µ—Ç `typedef T type`, –∏ —ç—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —à–∞–±–ª–æ–Ω–∞.

–ê —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–∏–µ –¥–ª—è `std::enable_if` –Ω–∞–º –ø–æ–º–æ–≥—É—Ç type traits, –≤–µ–¥—å –æ–Ω–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∞–º—ã—Ö —Ä–∞–∑–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤ —Ç–∏–ø–æ–≤.

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏–¥–µ—è –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫: –ï—Å—Ç—å –≤—ã—à–µ–æ–ø–∏—Å–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `std::enable_if`. –ï—Å–ª–∏ –º—ã –ø–µ—Ä–µ–¥–∞–µ–º –≤ –µ—ë —à–∞–±–ª–æ–Ω `true`, —É –Ω–µ—ë –ø–æ—è–≤–∏—Ç—Å—è `::type`, –∏–Ω–∞—á–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ø—É—Å—Ç–æ–π. –ù—É–∂–Ω–æ–µ –Ω–∞–º —É—Å–ª–æ–≤–∏–µ –º—ã –ø–æ–ª—É—á–∞–µ–º –≤—ã–∑–æ–≤–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —à–∞–±–ª–æ–Ω–∞ type trais. –ê –∑–∞—Ç–µ–º —Å–æ—à–ª—ë–º—Å—è –Ω–∞ `::type`. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ–µ –Ω–∞–º —É—Å–ª–æ–≤–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –º—ã —Å—Å—ã–ª–∞–µ–º—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ::type, –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω—É–∂–Ω–∞—è –Ω–∞–º –æ—à–∏–±–∫–∞ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏, –∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –¥—Ä—É–≥–æ–º—É –≤–∞—Ä–∏–∞–Ω—Ç—É —à–∞–±–ª–æ–Ω–∞. –ù–æ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–µ –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–Ω–æ–≤–∫–∏, –∏ —ç—Ç–æ (–Ω–∞–¥–µ–µ–º—Å—è) –æ–∫–∞–∂–µ—Ç—Å—è –Ω—É–∂–Ω—ã–π –Ω–∞–º –≤–∞—Ä–∏–∞–Ω—Ç.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –º—ã –º–æ–∂–µ–º —ç—Ç–æ–≥–æ —Å–¥–µ–ª–∞—Ç—å:

```c++
#include <iostream>
#include <type_traits>
 
template <typename T>
typename std::enable_if <std::is_integral<T>::value>::type 
func (T value) // –ø–æ —Ñ–∞–∫—Ç—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç void
{
   std::cout << value << ": integer" << std::endl;
}
 
template <typename T>
typename std::enable_if <std::is_floating_point<T>::value>::type 
func (T value) // –ø–æ —Ñ–∞–∫—Ç—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç void
{
   std::cout << value << ": float" << std::endl;
}
 
int main ()
{
    func (5u);
    func (3.14);
    return 0;
}
 
// 5: integer
// 3.14: float
```

–í —ç—Ç–æ–º –º–µ—Å—Ç–µ C#-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –Ω–µ–º–Ω–æ–≥–æ –∑–∞–≤–∏–¥—É—é—Ç, —Ç. –∫. –ø–æ–¥–æ–±–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç—ã generic-—Ç–∏–ø–æ–≤ –∑–∞–¥–∞—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. üôÇ

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: SFINAE –Ω–µ —Å–º–æ—Ç—Ä–∏—Ç –≤–Ω—É—Ç—Ä—å —Ç–µ–ª–∞ —Ñ—É–Ω–∫—Ü–∏–π. –ï—ë –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –∑–∞–ª–∞–¥–∏—Ç—Å—è —Å —Ç–µ–ª–æ–º, —Ç–æ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –æ–±—ã—á–Ω–∞—è –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –¥—Ä—É–≥–æ–º—É –≤–∞—Ä–∏–∞–Ω—Ç—É –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç.
